<?xml version="1.0"?>
<tool_dependency>
    <package name="libgd" version="2.1.0">
        <repository name="package_libgd_2_1" owner="iuc" prior_installation_required="True" />
    </package>
    <package name="trans_proteomic_pipeline" version="4.6.3">
        <install version="1.0">
            <actions>
                <action type="setup_perl_environment">
                    <repository name="package_perl_5_18" owner="iuc">
                        <package name="perl" version="5.18.1" />
                    </repository>
                   <!-- allow downloading and installing an Perl package from cpan.org-->
                   
                   <package>http://search.cpan.org/CPAN/authors/id/T/TO/TODDR/XML-Parser-2.41.tar.gz</package>
                   <!-- Also possible but not reproducible, due to the fact that always the latest version is installed.
                   <package>XML::Parser</package>
                   -->
                   <package>http://search.cpan.org/CPAN/authors/id/L/LD/LDS/CGI.pm-3.43.tar.gz</package>
                   
                   
                </action>
                <action type="download_file">https://downloads.sourceforge.net/project/sashimi/Trans-Proteomic%20Pipeline%20%28TPP%29/TPP%20v4.6%20%28occupy%29%20rev%203/TPP-4.6.3.tgz</action>
                <!-- populate the environment variables from the dependend repos -->
                <action type="set_environment_for_install">
                    <repository name="package_libgd_2_1" owner="iuc">
                        <package name="libgd" version="2.1.0" />
                    </repository>
                </action>
                <action type="shell_command">tar xfz TPP-4.6.3.tgz</action>
                <!-- doanload patched version of htmldoc to prevent a TPP crashed during compilation -->
                <action type="download_file">https://github.com/bgruening/download_store/raw/master/htmldoc/htmldoc-1.8.27-8.debian.patched.tar.gz</action>

                <action type="move_file">
                    <source>htmldoc-1.8.27-8.debian.patched.tar.gz</source>
                    <destination>./TPP-4.6.3/extern/htmldoc.tgz</destination>
                </action>

                <action type="change_directory">./TPP-4.6.3/trans_proteomic_pipeline/src/</action>
                <action type="shell_command">echo 'TPP_ROOT=$INSTALL_DIR/tpp' &gt; Makefile.config.incl</action>
                <action type="shell_command">ls -l > $INSTALL_DIR/foo.txt</action>
                <action type="shell_command">cat Makefile.config.incl > $INSTALL_DIR/foo2.txt</action>
                <action type="shell_command">export PERL5LIB=$INSTALL_DIR/lib/perl5/:$PERL5LIB &amp;&amp; export PATH=$PERL_ROOT_DIR/bin/:$PATH &amp;&amp; make</action>
                <action type="shell_command">make install</action>
                <action type="set_environment">
                    <environment_variable action="prepend_to" name="PATH">$INSTALL_DIR/bin</environment_variable>
                    <environment_variable action="set_to" name="TPP_ROOT_PATH">$INSTALL_DIR</environment_variable>
                </action>
            </actions>
        </install>
        <readme>
            Installs and complils the trans proteomic pipeline in version 4.6.3.
            The Trans-Proteomic Pipeline (TPP) is a collection of integrated tools for MS/MS proteomics, developed at the SPC.

            http://tools.proteomecenter.org/

            PATH will be set.
            TPP_ROOT_PATH will point to the root path of the installation.
        </readme>
    </package>
</tool_dependency>
