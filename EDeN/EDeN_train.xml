<tool id="bg_eden_test" name="EDeN Test" version="0.1">
    <description></description>
    <requirements>
    </requirements>
    <command>
        EDeN --action TRAIN

        --input_data_file_name $infile
        --file_type "SPARSE_VECTOR"
        --binary_file_type

        ## TODO: we need a tool that creates such a file, maybe from the metadata of an SDF file
        ## target_file_name is a file with 1 or -1 one in each row, indicating the class
        --target_file_name $target_infile
        --model_file_name $model_outfile

        --lambda $lambda ##??? notation?
        --epochs $epoch
        
        --sparsification_num_iterations $sparsification_num_iterations
        --topological_regularization_num_neighbors $topological_regularization_num_neighbors
        --topological_regularization_decay_rate $topological_regularization_decay_rate

        --num_iterations $num_iterations
        --threshold $threshold
        --only_positive $only_positive
        --only_negative $only_negative

        --random_seed $random_seed

    </command>
    <inputs>
        <param format="eden_sparse_vector" name="infile" type="data" label="Input Graph" help=""/>
        <param format="txt" name="target_infile" type="data" label="Target file" help=""/>

        <param name="kernel_type" type="select" display="radio" label="Type of the Kernel">
            <option value="NSPDK">NSPDK</option>
            <option value="WDK">WDK</option>
            <option value="PBK">PBK</option>
            <option value="USPK">USPK</option>
            <option value="DDK">DDK</option>
            <option value="NSDDK">ANSDDK</option>
            <option value="SK">SK [NSPDK]</option>
        </param>

        <param name="graph_type" type="select" display="radio" label="Type of Graph">
            <option value="DIRECTED">directed</option>
            <option value="UNDIRECTED">undirected</option>
        </param>

        <param name="epoch" type="integer" value="10" label="Epoch, Stochastic gradient descend algorithm." help="">
            <validator type="in_range" min="1" />
        </param>
        <param name="lambda" type="text" value="1e-4" label="lambda, Stochastic gradient descend algorithm." help="" />

    </inputs>
    <outputs>
        <data format="txt" name="model_outfile" label="Train Model from ${on_string}"/>
    </outputs>
    <tests>
        <test>
            <param name="infile" value="3_molceuls.sdf" />
            <output name="outfile" file="3_molecules.gspan" />
        </test>
    </tests>
    <help>

.. class:: infomark

**What it does** 

The linear model is induced using the accelerated stochastic gradient descent technique by Léon Bottou and Yann LeCun.
When the target information is 0, a self-training algorithm is used to impute a positive or negative class to the unsupervised instances.
If the target information is imbalanced a minority class resampling technique is used to rebalance the training set.

This tool is part of the EDeN (Explicit Decomposition with Neighborhoods) suite, developed by Fabrizio Costa.


REFERENCES
==========

The code for Stochastic Gradient Descent SVM is adapted from http://leon.bottou.org/projects/sgd. Léon Bottou and Yann LeCun, ''Large Scale Online Learning'', Advances in Neural Information Processing Systems 16, Edited by Sebastian Thrun, Lawrence Saul and Bernhard Schölkopf, MIT Press, Cambridge, MA, 2004.



    </help>
</tool>
