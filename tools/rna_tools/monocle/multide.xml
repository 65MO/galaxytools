<tool id="celldataset_mulitde" name="Multifactorial DE" version="1.2.0">
    <description>
        of Single Cell Data Set 
    </description>
    <stdio>
        <exit_code range="1:" level="fatal" description="Error occurred. Please check Tool Standard Error" />
        <exit_code range=":-1" level="fatal" description="Error occurred. Please check Tool Standard Error" />
    </stdio>
    <command interpreter="">
<![CDATA[
    Rscript $__tool_directory__/multiDE.R
        $cell_data_set
        "$genes"
        "$fullformulastring"
        "$reducedformulastring"
        $out_file1 
]]>
    </command>
    <inputs>
        <param name="cell_data_set" type="data" format="data" label="Cell Dataset" />
        <!-- TODO: 1. Implement this; 2. make this dependent on the input data type (ordered/unordered single cell dataset) 
        <param name="ordered_flag" type="boolean" checked="false" truevalue="T" falsevalue="F" label="Are the cells already ordered?"  /> -->
        <param name="genes" type="text" label="Genes short names" />
        <param name="fullformulastring" type="text" default="expression~Media*Time" label="Full Model Formula String" >
            <sanitizer>
                <valid>
                    <add value="~"/> 
                </valid>
            </sanitizer>
        </param>
        <param name="reducedformulastring" type="text" default="expression~Media" label="Reduced Model Formula String" >
            <sanitizer>
                <valid>
                    <add value="~"/> 
                </valid>
            </sanitizer>
        </param>
    </inputs>
    <outputs>
        <data name="out_file1" format="tabular" />          
    </outputs>
    <help>
    </help>
    <citations>
        <citation type="doi">10.1038/nbt.2859</citation>
    </citations>
</tool>
