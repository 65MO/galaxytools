<tool id="twistdna" name="TwistDNA" version="0.1.0">
    <description>Twist-DNA allows visualization of results in standard genome browsers to compare DNA opening properties to other available datasets</description>
    <requirements>
        <requirement type="package" version="1.1">twistdna</requirement>
    </requirements>
    <command>
    #if $advanced == true:
        python \$TWISTDNA_SCRIPT_PATH/create_input_dat.py $temperature $sigma $salt $small_bubble $large_bubble $bubble_size_step $threshold
    #else
        cp \$TWISTDNA_SCRIPT_PATH/standardconfig input.dat
    #end if
TwistDNA &lt; $input
    </command>
    <stdio>
        <exit_code range="1:" level="fatal" description="Error occurred. Please check Tool Standard Error" />
        <exit_code range=":-1" level="fatal" description="Error occurred. Please check Tool Standard Error" />
    </stdio>
    <inputs>
        <param format="fasta" name="input" type="data" label="Input Alignment File" />
        <conditional name="check">
            <param name="advanced" type="boolean" truevalue="yes" falsevalue="no" label="Show advanced Options" help="" checked="false" />
            <when value="yes">
                <param name="temperature" label="Temperature in Celsius" type="float" value="37" />
                <param name="sigma" label="Superhelical density Sigma" type="float" value="-0.06" />
                <param name="salt" label="Salt concentration CNa" type="float" value="0.1" />
                <param name="small_bubble" label="Smallest bubble size bsizemin" type="float" value="1" />
                <param name="large_bubble" label="Largest bubble size bsizemax" type="float" value="0" />
                <param name="bubble_size_step" label="Bubble size step bstep" type="float" value="1" />
                <param name="threshold" label="Bubble storing threshold" type="float" value="-3.0" />
            </when>
         </conditional>
    </inputs>
    <outputs>
        <data name="outfile1" format="bed" />
        <data name="outfile2" format="bed" />
    </outputs>
    <help>**What it does**
    http://www.cbp.ens-lyon.fr/doku.php?id=developpement:productions:logiciels:twistdna

    Local opening of the DNA double-helix is required in many fundamental biological processes and is in part controlled by the degree of superhelicity imposed in vivo by the protein machinery. In particular, positions of superhelically destabilized regions correlate with regulatory sites along the genome. Based on a self-consistent linearization of a thermodynamic model of superhelical DNA introduced by Benham, we have developed Twist-DNA, a program that predicts the locations of these regions by efficiently computing base-pair and bubble opening probabilities in genomic DNA. The program allows visualization of results in standard genome browsers to compare DNA opening properties to other available datasets. 
    </help>
</tool>
