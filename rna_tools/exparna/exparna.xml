<tool id="exparna" name="ExpaRNA" version="0.1.0">
    <description></description>
    <requirements>
        <requirement type="package" version="1.0">exparna</requirement>
        <requirement type="set_environment">EXPARNA_SCRIPT_PATH</requirement>
    </requirements>
    <command>
ExpaRNA 
-t$emp_scoring
-s$min_incl_sub
-n$max_used_sub
$locarna_input
$alignment_to_file
$list_in_file
$all_in_file
$fastafile;
    mkdir $outfile.files_path;
    cp ./ExpaRNA-results/* $outfile.files_path;
    python /home/bernhard/galaxytools/rna_tools/exparna/create_html.py $outfile $outfile.files_path;
    </command>
    <stdio>
        <exit_code range="1:" level="fatal" description="Error occurred. Please check Tool Standard Error" />
        <exit_code range=":-1" level="fatal" description="Error occurred. Please check Tool Standard Error" />
    </stdio>
    <inputs>
        <param format="fasta" name="fastafile" type="data" label="Fasta Input File" />
        <param name="min_incl_sub" label="Minimal size of included substructures" type="integer" value="7" help="-s" />
        <conditional name="check">
            <param name="check_all" type="boolean" truevalue="yes" falsevalue="no" label="Use all substructures" help="" checked="true" />
            <when value="no">
            <param name="max_used_sub" label="Maximum number of used substructures" type="integer" value="0" help="-n" />
            </when>
         </conditional>
         
        <param name="emp_scoring" type="select" value="no" label="EPM Scoring" help="-t">
                        <option value="1" selected="true">Default</option>
                        <option value="2">Prefer Larger Patterns</option>
        </param>
        <!-- output parameter alles booleans
        /!-->
        <param name="locarna_input" type="boolean" checked="true" truevalue="-i" falsevalue="" label="Write ExpaRNA result as input for LocARNA with anchor constraints" help="-i" />
        <param name="alignment_to_file" type="boolean" checked="false" truevalue="-o" falsevalue="" label="Write ExpaRNA result as alignment into text file" help="-o" />
        <param name="list_in_file" type="boolean" checked="false" truevalue="-e" falsevalue="" label="Write ExpaRNA result as list in file" help="-e" />
        <param name="all_in_file" type="boolean" checked="false" truevalue="-a" falsevalue="" label="Write all EPMs into file" help="-a" />
    </inputs>
    <outputs>
        <data name="outfile" format="zip" />
    </outputs>
    <help>**What it does**
    http://rna.informatik.uni-freiburg.de/ExpaRNA/Input.jsp
    ExpaRNA is a fast, motif-based comparison and alignment tool for RNA molecules. Instead of computing a full sequence-structure alignment, it computes the best arrangement of sequence-structure motifs common to two RNAs. A motif is a local (or isolated) substructure which is identical to both RNAs. ExpaRNA requires a given nested secondary structure for both RNAs. If no structure is available, RNAfold from Vienna RNA Package is used for a structure prediction. The accuracy of the algorithm is mainly controlled by the minimal size of the included sequence-structure motifs. ExpaRNA is especially useful for comparative structural RNA analysis and to speed-up complex sequence-structure alignment methods. For this purpose, the predicted common substructures by ExpaRNA are used as anchor constraints for a full structural alignment.
    
    **Output**
    You will receive a zip file containing all output files 
    </help>
</tool>
