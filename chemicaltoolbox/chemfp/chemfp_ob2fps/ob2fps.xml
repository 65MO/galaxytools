<tool id="chemfp_ob2fps" name="Molecules to Fingerprints" version="0.1.2">
    <description>with different fingerprint types</description>
    <parallelism method="multi" split_inputs="infile" split_mode="to_size" split_size="10000" shared_inputs="" merge_outputs="outfile"></parallelism>
    <requirements>
        <requirement type="package" version="1.1p1">chemfp</requirement>
    </requirements>
    <command>
        ob2fps $fptype --in "${infile.ext}" "${infile}" -o "${outfile}" --errors report 2>&#38;1
    </command>
    <inputs>
        <param name="infile" type='data' format="sdf,smi,mol,mol2,cml,inchi" label="molecule file"/>
        <param name='fptype' type='select' format='text'>
            <option value='--FP2'>FP2</option>
            <option value='--FP3'>FP3</option>
            <option value='--FP4'>FP4</option>
            <option value='--MACCS'>MACCS</option>
        </param>
    </inputs>
    <outputs>
        <data name="outfile" format="fps" />
    </outputs>
    <tests>
        <!-- FP2 -->
        <test>
            <param name="infile" value="CID_2244.sdf" ftype="sdf" />
            <param name="fptype" value="--FP2" />
            <output name="outfile" file="CID_2244_FP2.fps" ftype="fps" />
        </test>
        <test>
            <param name="infile" value="CID_2244.smi" ftype="smi" />
            <param name="fptype" value="--FP2" />
            <output name="outfile" file="CID_2244_FP2.fps" ftype="fps" />
        </test>
        <!-- FP3 -->
        <test>
            <param name="infile" value="CID_2244.sdf" ftype="sdf" />
            <param name="fptype" value="--FP3" />
            <output name="outfile" file="CID_2244_FP3.fps" ftype="fps" />
        </test>
        <test>
            <param name="infile" value="CID_2244.smi" ftype="smi" />
            <param name="fptype" value="--FP3" />
            <output name="outfile" file="CID_2244_FP3.fps" ftype="fps" />
        </test>
        <!-- FP4 -->
        <test>
            <param name="infile" value="CID_2244.sdf" ftype="sdf" />
            <param name="fptype" value="--FP4" />
            <output name="outfile" file="CID_2244_FP4.fps" ftype="fps" />
        </test>
        <test>
            <param name="infile" value="CID_2244.smi" ftype="smi" />
            <param name="fptype" value="--FP4" />
            <output name="outfile" file="CID_2244_FP4.fps" ftype="fps" />
        </test>
        <!-- MACCS -->
        <test>
            <param name="infile" value="CID_2244.sdf" ftype="sdf" />
            <param name="fptype" value="--MACCS" />
            <output name="outfile" file="CID_2244_MACCS.fps" ftype="fps" />
        </test>
        <test>
            <param name="infile" value="CID_2244.smi" ftype="smi" />
            <param name="fptype" value="--MACCS" />
            <output name="outfile" file="CID_2244_MACCS.fps" ftype="fps" />
        </test>
    </tests>
    <help>


**What it does**

Generate fingerprints using OpenBabel

-----

**Example**

* input::
	
	      - SDF File

		28434379
		  -OEChem-02031205132D

		 37 39  0     0  0  0  0  0  0999 V2000
		    8.1648   -1.8842    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
		    6.0812   -0.2134    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
		    6.0812   -1.8229    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
		    2.5369   -2.0182    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
		    6.3919    0.7371    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
		    7.3704    0.9433    0.0000 C   0  0  0  0 
		    ......
		  1 15  1  0  0  0  0
		  1 35  1  0  0  0  0
		  2  5  1  0  0  0  0
		  2 11  1  0  0  0  0
		  2 12  1  0  0  0  0
		  3 12  2  0  0  0  0
		  3 13  1  0  0  0  0
		  4 18  1  0  0  0  0
		  ......

			&gt;PUBCHEM_COMPOUND_CID&lt;
			28434379

			&gt; &lt;PUBCHEM_COMPOUND_CANONICALIZED&gt;
			1

			&gt; &lt;PUBCHEM_CACTVS_COMPLEXITY&gt;
			280

			&gt; &lt;PUBCHEM_CACTVS_HBOND_ACCEPTOR&gt;
			2

			&gt; &lt;PUBCHEM_CACTVS_HBOND_DONOR&gt;
			2

			&gt; &lt;PUBCHEM_CACTVS_ROTATABLE_BOND&gt;
			2

			&gt; &lt;PUBCHEM_CACTVS_SUBSKEYS&gt;
			AAADceBzIAAAAAAAAAAAAAAAAAAAAWAAAAAwYAAAAAAAAFgB8AAAHgAQCAAACCjhlwYx0LdMEgCgASZiZASCgC0hEqAJ2CA4dJiKeKLA2dGUJAhokALYyCcQAAAAAACAAAQAACAAAQAACAAAQAAAAAAAAA==

			&gt;

		- type : FP2

* output::

	#FPS1
	#num_bits=1021
	#type=OpenBabel-FP2/1
	#software=OpenBabel/2.3.0
	#source=/tmp/dataset_409.dat.sdf
	#date=2012-02-03T11:13:39
	c0000000000008c0000846000400000000000010800000000000004000000000100010000700802170000018000000c
	0010000000020600208008000008000000c000c02c00002000000c00000100000008001400c800001c0180000000300
	10000000000080000000c0000060000c0000060810000010000000800102000000	28434379


    </help>
</tool>
