<tool id="ob_genProp" name="Compute physico-chemical properties" version="1.0">
    <description>for a set of molecules</description>
    <parallelism method="multi" split_inputs="infile" split_mode="to_size" split_size="10000" shared_inputs="" merge_outputs="outfile"></parallelism>
    <requirements>
        <requirement type="package" version="2.3.2">openbabel</requirement>
        <requirement type="package" version="0.1">cheminfolib</requirement>
    </requirements>
    <command interpreter="python">
    ob_genProp.py
      -i "${infile}"
      --iformat "${infile.ext}"
      --oformat "${output_opts.output_format_types}"
      #if $output_opts.header.value:
        --header $output_opts.header
      #end if
      -o "${outfile}"
  </command>
  <inputs>
    <param name="infile" type="data" format="sdf,mol,mol2,cml,inchi,smi" label="Select input file with multiple molecules."/>
    <conditional name="output_opts">
      <param name="output_format_types" type="select" label="Specify output format file">
        <option value="table">Tabular format</option>
        <option value="sdf" selected="True">sdf</option>
      </param>
      <when value="table">
        <param name="header" type="boolean" checked="False" label="Print the headers of the table as the first row of the table"/>
      </when>
      <when value="sdf">
        <param name="header" type="hidden"/>
      </when>
    </conditional>
  </inputs>
  <outputs>
    <data format="tabular" name="outfile" label="${tool.name} on ${on_string}">
        <change_format>
            <when input="output_opts.output_format_types" value="sdf" format="sdf"/>
        </change_format>
    </data>
  </outputs>
  <tests>
    <test>
        <param name="infile" ftype="sdf" value="CID_2244.sdf"/>
        <param name="output_format_types" value="sdf" />
        <output name="outfile" ftype="sdf" file="ob_genprop_on_CID2244.sdf" />
    </test>
    <test>
        <param name="infile" ftype="sdf" value="CID_2244.sdf"/>
        <param name="output_format_types" value="table" />
        <param name="header" value="true" />
        <output name="outfile" ftype="sdf" file="ob_genprop_on_CID2244.tabular" />
    </test>
  </tests>
  <help>

.. class:: infomark

**What does this tool do?**

  This tool computes several physico-chemical properties for a set of molecules.

-----

.. class:: warningmark

**Tip:** the generation of Spectrophores(TM) requires the previous addition of explicit hydrogen atoms and the proper definition of 3D coordinates. The user is directed towards the corresponding tools if accurate Spectrophores(TM) descriptors are required.

-----

.. class:: infomark

**Input:** molecular file in sdf or mol2 format files. The input file may contain multiple molecules. 3D coordinates of the files have to be provided.

**Output:** this program generates an sdf file containing several computed physico-chemical properties stored as meta-data, or a tabular formatted file with the meta-data stored in columns.

-----

.. class:: infomark

The following **physico-chemical properties and descriptors** are computed for each molecule:

    # number of hydrogen-bond donor and acceptor groups

    # number of rotatable bonds

    # logP

    # number of rings

    # number of heavy atoms

    # molecular weight

    # total Polar Surface Area

    # molecular refractivity

    # Canonical SMILES

    # InChI string

    # InChI-Key

    # Spectrophores(TM)

-----

**This tool uses Pybel:** N. M. O'Boyle, C. Morley and G. R. Hutchison. Pybel: a Python wrapper for the OpenBabel cheminformatics toolkit Chem. Cent. J. 2008, 2, 5.

**Spectrophores(TM)** is a registered tool implemented in the open-source OpenBabel. Copyright (C) 2005-2010 by Silicos NV.

  </help>
</tool>
