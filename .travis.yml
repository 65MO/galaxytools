sudo: required

language: python
python: 2.7

services:
  - docker

before_install:
  - sudo apt-get update -qq -y
  - sudo apt-get install -qq -y libxml2-utils
  - |
    docker run -d -p 8080:80 \
    -e GALAXY_CONFIG_ALLOW_USER_DATASET_PURGE=True \
    -e GALAXY_CONFIG_ALLOW_LIBRARY_PATH_PASTE=True \
    -e GALAXY_CONFIG_ENABLE_USER_DELETION=True \
    -e GALAXY_CONFIG_ENABLE_BETA_WORKFLOW_MODULES=True \
    -v /tmp/:/tmp/ \
    bgruening/galaxy-stable:dev
  - docker ps

install:
  - pip install click==5.1
  - pip install planemo

script:
  - planemo --version
  - planemo shed_lint --report_level warn --tools --fail_level error --recursive .
  - sh .tests/extensive.sh
