<tool id="trnascan" name="tRNAscan" version="0.1">
  <description>tRNA Scan</description>
  <command >tRNAscan-SE $organism $mode $showPrimSecondOpt $disablePseudo $showCodons -d -Q -y -q -b -o $output $inputfile > /dev/null </command>
  <inputs>
	<param name="inputfile" type="data" format="fasta" label="Genome Sequence" help="Dataset missing? See TIP below"/>
	<param name="organism" type="select" format="text">
		<label>Select Organsim</label>
		<option value="-G">general tRNA model</option>
		<option value="-B">Bacterial</option>
		<option value="-A">Archaeal</option>
		<option value="-O">Mito/Chloroplast </option>
	</param>
	<param name="mode" type="select" format="text">
		<label>Select Mode</label>		
		<option value=""> Default</option>
		<option value="-C"> Cove only (very slow)</option>
		<option value="-T"> tRNAscan only</option>
		<option value="-E "> EufindtRNA only</option>
	</param>		
	<param name='disablePseudo' type='boolean' label='Disable pseudo gene checking' truevalue='-D' falsevalue='' >	</param>
	<param name='showPrimSecondOpt' type='boolean'  label='Show primary and secondary structure components to Cove scores ' truevalue="-H" falsevalue=''></param>
	<param name='showCodons' type='boolean' label='Show codons instead of tRNA anticodons' truevalue='-N' falsevalue=''></param>
  </inputs>
  <outputs>
    <data format="tabular" name="output" />
  </outputs>
  <tests>
	<test>
		<param name="inputfile" ftype="fasta" value='trna/trnaTestData.fa' />
		<param name="organism" value='general tRNA model' />
		<param name="mode" value="" />		
		<param name='disablePseudo' value=''/>
		<param name='showPrimSecondOpt' value="" />
		<param name='showCodons' value='' />
		<output name="output" file='trna/trnaTestOutput.dat'/>
	</test>	
 </tests>

<help>

.. class:: warningmark

**TIP** This tool requires *fasta* format.

-----

**What it does**

	tRNAscan-SE was designed to make rapid, sensitive searches of genomic
	sequence feasible using the selectivity of the Cove analysis package.
	We have optimized search sensitivity with eukaryote cytoplasmic and
	eubacterial sequences, but it may be applied more broadly with a
	slight reduction in sensitivity .
	http://lowelab.ucsc.edu/tRNAscan-SE/

-----

**Organisim**

- use general tRNA model:

	This option selects the general tRNA covariance model that was trained
	on tRNAs from all three phylogenetic domains (archaea, bacteria, and
	eukarya).  This mode can be used when analyzing a mixed collection of
	sequences from more than one phylogenetic domain, with only slight
	loss of sensitivity and selectivity.  The original publication
	describing this program and tRNAscan-SE version 1.0 used this general
	tRNA model exclusively.  If you wish to compare scores to those found
	in the paper or scans using v1.0, use this option.  Use of this option
	is compatible with all other search mode options described in this
	section.

- search for bacterial tRNAs

	This option selects the bacterial covariace model for tRNA analysis,
	and loosens the search parameters for EufindtRNA to improve detection
	of bacterial tRNAs.  Use of this mode with bacterial sequences
	will also improve bounds prediction of the 3' end (the terminal CAA
	triplet).

- search for archaeal tRNAs

	This option selects an archaeal-specific covariance model for tRNA
	analysis, as well as slightly loosening the EufindtRNA search
	cutoffs.

- search for organellar (mitochondrial/chloroplast) tRNAs

	This parameter bypasses the fast first-pass scanners that are poor at
	detecting organellar tRNAs and runs Cove analysis only.  Since true
	organellar tRNAs have been found to have Cove scores between 15 and 20
	bits, the search cutoff is lowered from 20 to 15 bits.  Also,
	pseudogene checking is disabled since it is only applicable to
	eukaryotic cytoplasmic tRNA pseudogenes.  Since Cove-only mode is
	used, searches will be very slow (see -C option below) relative to the
	default mode.

------

**Mode**

- search using Cove analysis only (max sensitivity, slow)

	Directs tRNAscan-SE to analyze sequences using Cove analysis only.
	This option allows a slightly more sensitive search than the default
	tRNAscan + EufindtRNA -> Cove mode, but is much slower (by approx. 250
	to 3,000 fold).  Output format and other program defaults are
	otherwise identical to the normal analysis.

- search using Eukaryotic tRNA finder (EufindtRNA) only:

	This option runs EufindtRNA alone to search for tRNAs.  Since Cove is
	not being used as a secondary filter to remove false positives, this
	run mode defaults to "Normal" parameters which more closely
	approximates the sensitivity and selectivity of the original algorithm
	describe by Pavesi and colleagues.

- search using tRNAscan only (defaults to strict search params)

	Directs tRNAscan-SE to use only tRNAscan to analyze sequences.  This
	mode will cause tRNAscan to default to using "strict" parameters
	(similar to tRNAscan version 1.3 operation).  This mode of operation
	is faster (about 3-5 times faster than default mode analysis), but
	will result in approximately 0.2 to 0.6 false positive tRNAs per Mbp,
	decreased sensitivity, and less reliable prediction of anticodons,
	tRNA isotype, and introns.

-----

**disable pseudogene checking**

	Manually disable checking tRNAs for poor primary or secondary
	structure scores often indicative of eukaryotic pseudogenes.  This
	will slightly speed the program and may be necessary for non-eukaryotic
	sequences that are flagged as possible pseudogenes but are known to be
	functional tRNAs.

-----

**Show both primary and secondary structure score components to covariance model bit scores**

	This option displays the breakdown of the two components of the
	covariance model bit score.  Since tRNA pseudogenes often have one
	very low component (good secondary structure but poor primary sequence
	similarity to the tRNA model, or vice versa), this information may be
	useful in deciding whether a low-scoring tRNA is likely to be a
	pseudogene.  The heuristic pseudogene detection filter uses this
	information to flag possible pseudogenes -- use this option to see why
	a hit is marked as a possible pseudogene.  The user may wish to
	examine score breakdowns from known tRNAs in the organism of interest 
	to get a frame of reference.

-----

**Show codons instead of tRNA anticodons**

	This option causes tRNAscan-SE to output a tRNA's corresponding codon
	in place of its anticodon.

-----

**Example**

* input::

	-Genome Sequence

	CELF22B7  C.aenorhabditis elegans (Bristol N2) cosmid F22B7
	GATCCTTGTAGATTTTGAATTTGAAGTTTTTTCTCATTCCAAAACTCTGT
	GATCTGAAATAAAATGTCTCAAAAAAATAGAAGAAAACATTGCTTTATAT
	TTATCAGTTATGGTTTTCAAAATTTTCTGACATACCGTTTTGCTTCTTTT
	TTTCTCATCTTCTTCAAATATCAATTGTGATAATCTGACTCCTAACAATC
	GAATTTCTTTTCCTTTTTCTTTTTCCAACAACTCCAGTGAGAACTTTTGA
	ATATCTTCAAGTGACTTCACCACATCAGAAGGTGTCAACGATCTTGTGAG
	AACATCGAATGAAGATAATTTTAATTTTAGAGTTACAGTTTTTCCTCCGA
	CAATTCCTGATTTACGAACATCTTCTTCAAGCATTCTACAGATTTCTTGA
	TGCTCTTCTAGGAGGATGTTGAAATCCGAAGTTGGAGAAAAAGTTCTCTC
	AACTGAAATGCTTTTTCTTCGTGGATCCGATTCAGATGGACGACCTGGCA
	GTCCGAGAGCCGTTCGAAGGAAAGATTCTTGTGAGAGAGGCGTGAAACAC
	AAAGGGTATAGGTTCTTCTTCAGATTCATATCACCAACAGTTTGAATATC
	CATTGCTTTCAGTTGAGCTTCGCATACACGACCAATTCCTCCAACCTAAA
	AAATTATCTAGGTAAAACTAGAAGGTTATGCTTTAATAGTCTCACCTTAC
	GAATCGGTAAATCCTTCAAAAACTCCATAATCGCGTTTTTATCATTTTCT
	.....
	- organisim : Mixed (general tRNA model)
	- mode : Default
	- disable pseudogene checking : not checked
	- Show both primary and secondary structure score components to covariance model bit scores : not checked
	- Show codons instead of tRNA anticodons : not checked

* output::

	Sequence 		tRNA 	Bounds	tRNA	Anti	Intron Bounds	Cove	Hit
	Name     	tRNA #	Begin	End  	Type	Codon	Begin	End	Score	Origin
	-------- 	------	---- 	------	----	-----	-----	----	------	------
	CELF22B7 	1	12619	12738	Leu	CAA	12657	12692	55.12	Bo
	CELF22B7 	2	19480	19561	Ser	AGA	0	0	66.90	Bo
	CELF22B7 	3	26367	26439	Phe	GAA	0	0	73.88	Bo
	CELF22B7 	4	26992	26920	Phe	GAA	0	0	73.88	Bo
	CELF22B7 	5	23765	23694	Pro	CGG	0	0	60.58	Bo



-------

**References**

Todd M. Lowe and Sean R. Eddy
tRNAscan-SE: A Program for Improved Detection of Transfer RNA Genes in Genomic Sequence Nucl. Acids Res. (1997) 25(5): 0955-964
doi:10.1093/nar/25.5.0955 

 </help>

</tool>
