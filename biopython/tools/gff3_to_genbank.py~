#!/usr/bin/env python
"""
    Convert a GFF and the associated sequence (FASTA) into GenBank format.

    Usage:
    gff_to_annotated_format.py <GFF annotation file> <FASTA sequence file>
"""
import os, sys
import argparse

from Bio import SeqIO
from Bio.Alphabet import generic_dna
from BCBio import GFF

def main( gfffile, fastafile, outfile, oformat ):
    fasta = SeqIO.to_dict(SeqIO.parse(fastafile, "fasta", generic_dna))
    gff = GFF.parse(gfffile, fasta)
    SeqIO.write(gff, outfile, oformat)

if __name__ == "__main__":
    parser = argparse.ArgumentParser(prog = 'GFF to GenBank converter.')
    parser.add_argument('--version', action='version', version='%(prog)s 0.1')
    parser.add_argument('--fasta', '-f', dest="fasta", help='FASTA sequence file')
    parser.add_argument('--gff', '-g', dest="gff", help='GFF file')
    parser.add_argument('--oformat', '-k', dest="oformat", help='output format, embl or genbank', choices=['embl', 'genbank'])
    
    
    parser.add_argument('--outfile', '-o', dest="outfile", help='output file')
    options = parser.parse_args()
    main( options.gff, options.fasta, options.outfile, options.oformat)

